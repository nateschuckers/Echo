<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account Profile</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="account_profile.js" defer></script>
    <script>
        // Theme and mode loader for iframe content
        document.addEventListener('DOMContentLoaded', () => {
            try {
                const savedTheme = window.parent.localStorage.getItem('andar-theme') || 'theme-blue';
                const savedMode = window.parent.localStorage.getItem('andar-mode') || 'light';
                document.documentElement.className = savedMode;
                document.body.classList.add(savedTheme);
            } catch (e) {
                console.error("Could not access parent localStorage for theming.", e);
                // Fallback to default theme if in a sandboxed environment
                document.documentElement.className = 'light';
                document.body.classList.add('theme-blue');
            }
        });
    </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200">
    <div id="account-profile-container">
        <!-- Main structure will be injected by JS -->
    </div>

    <!-- TEMPLATES FOR ACCOUNT PROFILE TABS -->

    <template id="profile-template">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Column: Profile Summary -->
            <div class="lg:col-span-1 space-y-6">
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 text-center">
                    <div id="account-initials" class="w-24 h-24 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-4xl font-bold mx-auto mb-4">A</div>
                    <h2 id="account-name" class="text-2xl font-bold">Alex Doe</h2>
                    <p class="text-gray-500 dark:text-gray-400">Product Manager at Tech Solutions Inc.</p>
                    <p class="text-sm text-gray-400 dark:text-gray-500">Informal: Alex | Formal: Mr. Doe</p>
                </div>
                <div class="editable-card bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 relative">
                    <div class="flex justify-between items-start"><h3 class="text-lg font-semibold mb-4">Contact Information</h3><button class="edit-icon p-1 text-gray-400 hover:text-primary"><svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125" /></svg></button></div>
                    <div id="profile-contact-info" class="space-y-4">
                        <!-- JS renders contact info here -->
                    </div>
                </div>
                <div class="editable-card bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 relative"><div class="flex justify-between items-start"><h3 class="text-lg font-semibold mb-4">Interests</h3><button class="edit-icon p-1 text-gray-400 hover:text-primary"><svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125" /></svg></button></div><div id="profile-interests" class="flex flex-wrap gap-2"><!-- JS renders interests here --></div></div>
                <div class="editable-card bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 relative"><div class="flex justify-between items-start"><h3 class="text-lg font-semibold mb-4">User Defined</h3><button class="edit-icon p-1 text-gray-400 hover:text-primary"><svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125" /></svg></button></div><div id="profile-user-defined" class="grid grid-cols-2 gap-4"><!-- JS renders user defined fields here --></div></div>
            </div>
            <!-- Right Column: Details -->
            <div class="lg:col-span-2 space-y-6">
                <div class="editable-card bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 relative"><div class="flex justify-between items-start"><h3 class="text-lg font-semibold mb-4">Details & Demographics</h3><button class="edit-icon p-1 text-gray-400 hover:text-primary"><svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125" /></svg></button></div><div id="profile-details" class="grid grid-cols-2 gap-4"><!-- JS renders details here --></div></div>
                <div class="editable-card bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 relative"><div class="flex justify-between items-start"><h3 class="text-lg font-semibold mb-4">Relationships</h3><button class="edit-icon p-1 text-gray-400 hover:text-primary"><svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125" /></svg></button></div><div id="profile-relationships" class="grid grid-cols-1 md:grid-cols-2 gap-4"><!-- JS renders relationships here --></div></div>
            </div>
        </div>
    </template>
    
    <template id="transactions-template">
        <div class="space-y-6">
            <!-- Stat Cards -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="stat-card"><div class="flex-1 text-center"><p id="lifetime-giving" class="text-3xl font-bold">$0</p><p class="text-sm text-gray-500 dark:text-gray-400">Lifetime Giving</p></div><i class="fa-solid fa-landmark text-3xl text-primary ml-4"></i></div>
                <div class="stat-card"><div class="flex-1 text-center"><p id="last-gift-amount" class="text-3xl font-bold">$0</p><p class="text-sm text-gray-500 dark:text-gray-400">Last Gift</p></div><i class="fa-solid fa-gift text-3xl text-green-500 ml-4"></i></div>
                <div class="stat-card"><div class="flex-1 text-center"><p id="largest-gift" class="text-3xl font-bold">$0</p><p class="text-sm text-gray-500 dark:text-gray-400">Largest Gift</p></div><i class="fa-solid fa-trophy text-3xl text-amber-500 ml-4"></i></div>
                <div class="stat-card"><div class="flex-1 text-center"><p id="giving-since" class="text-3xl font-bold">0</p><p class="text-sm text-gray-500 dark:text-gray-400">Giving Since</p></div><i class="fa-solid fa-calendar-days text-3xl text-blue-500 ml-4"></i></div>
            </div>

            <!-- Transaction Cards -->
            <div class="space-y-4">
                 <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200">Pledge History</h2>
                    <button class="flex items-center bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-dark transition duration-300 font-semibold whitespace-nowrap"><i class="fa-solid fa-plus mr-2"></i>Add Pledge</button>
                </div>
                <div id="transactions-container" class="space-y-4">
                    <!-- JS renders transaction cards here -->
                </div>
            </div>
        </div>
    </template>
    
    <template id="campaign-template">
        <div class="space-y-6">
             <!-- Charts -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex flex-col h-[350px]">
                    <h3 class="text-lg font-semibold mb-4 flex-shrink-0">3-Year Giving History</h3>
                    <div class="relative flex-grow">
                        <canvas id="giving-history-chart"></canvas>
                    </div>
                </div>
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 flex flex-col h-[350px]">
                    <div class="flex justify-between items-center mb-4 flex-shrink-0">
                        <h3 class="text-lg font-semibold">Designations</h3>
                        <div class="flex items-center space-x-2 text-sm">
                            <span>Prior Year</span>
                            <label for="designation-toggle" class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" value="" id="designation-toggle" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary"></div>
                            </label>
                            <span>Lifetime</span>
                        </div>
                    </div>
                    <div class="relative flex-grow min-h-0">
                        <canvas id="designation-chart"></canvas>
                    </div>
                </div>
            </div>
            <!-- Campaign History Table -->
            <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                 <h3 class="text-lg font-semibold mb-4">Workplace Campaign History</h3>
                 <div class="overflow-x-auto">
                    <table class="min-w-full">
                        <thead class="border-b border-gray-200 dark:border-gray-600">
                            <tr>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Year</th>
                                <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Employees</th>
                                <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Donors</th>
                                <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Participation</th>
                                <th class="px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Amount</th>
                            </tr>
                        </thead>
                        <tbody id="campaign-history-container" class="divide-y divide-gray-200 dark:divide-gray-700">
                            <!-- JS renders campaign history rows here -->
                        </tbody>
                    </table>
                 </div>
            </div>
        </div>
    </template>

    <template id="engagements-template">
       <div class="space-y-6">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700"><div class="flex justify-between items-center mb-4"><h3 class="text-lg font-semibold">Event Attendance</h3><button class="flex items-center bg-primary text-white px-3 py-1.5 rounded-lg hover:bg-primary-dark transition duration-300 text-sm font-semibold whitespace-nowrap"><i class="fa-solid fa-plus mr-2"></i>Add Attendance</button></div><div id="event-attendance-container" class="space-y-3"></div></div>
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700"><div class="flex justify-between items-center mb-4"><h3 class="text-lg font-semibold">Volunteer History</h3><button class="flex items-center bg-primary text-white px-3 py-1.5 rounded-lg hover:bg-primary-dark transition duration-300 text-sm font-semibold whitespace-nowrap"><i class="fa-solid fa-plus mr-2"></i>Add Opportunity</button></div><div id="volunteer-history-container" class="space-y-3"></div></div>
            </div>
        </div>
    </template>

    <template id="communications-template">
        <div class="space-y-6">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Communications Log -->
                <div class="lg:col-span-2 bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                    <div class="flex justify-between items-center mb-4"><h3 class="text-lg font-semibold">Communications Log</h3><button class="flex items-center bg-primary text-white px-3 py-1.5 rounded-lg hover:bg-primary-dark transition duration-300 text-sm font-semibold whitespace-nowrap"><i class="fa-solid fa-plus mr-2"></i>Add Log</button></div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                           <thead class="border-b border-gray-200 dark:border-gray-600"><tr><th class="w-12"></th><th class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Details</th><th class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Sender</th><th class="px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Date</th></tr></thead>
                            <tbody id="communications-log-container" class="divide-y divide-gray-200 dark:divide-gray-700">
                                <!-- JS renders communications here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- Notes & Documents -->
                <div class="space-y-6">
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                        <div class="flex justify-between items-center mb-4"><h3 class="text-lg font-semibold">Notes</h3><button class="flex items-center bg-primary text-white px-3 py-1.5 rounded-lg hover:bg-primary-dark transition duration-300 text-sm font-semibold whitespace-nowrap"><i class="fa-solid fa-plus mr-2"></i>Add Note</button></div>
                        <div id="notes-container" class="space-y-3"></div>
                    </div>
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700">
                        <div class="flex justify-between items-center mb-4"><h3 class="text-lg font-semibold">Documents</h3><button class="flex items-center bg-primary text-white px-3 py-1.5 rounded-lg hover:bg-primary-dark transition duration-300 text-sm font-semibold whitespace-nowrap"><i class="fa-solid fa-plus mr-2"></i>Add Document</button></div>
                        <div id="documents-container" class="space-y-3"></div>
                    </div>
                </div>
            </div>
        </div>
    </template>
</body>
</html>

